CREATE TABLE EMPLOYEE (
    SSN INT PRIMARY KEY,
    Name VARCHAR(100),
    Address VARCHAR(255),
    Sex CHAR(1),
    Salary DECIMAL(10,2),
    Super_SSN INT,
    D_No INT
);

CREATE TABLE DEPARTMENT (
    D_No INT PRIMARY KEY,
    D_Name VARCHAR(100),
    Mgr_SSN INT,
    Mgr_Start_Date DATE,
    FOREIGN KEY (Mgr_SSN) REFERENCES EMPLOYEE(SSN)
);

CREATE TABLE DLOCATION (
    D_No INT,
    D_Loc VARCHAR(100),
    FOREIGN KEY (D_No) REFERENCES DEPARTMENT(D_No)
);

CREATE TABLE PROJECT (
    P_No INT PRIMARY KEY,
    P_Name VARCHAR(100),
    P_Location VARCHAR(100),
    D_No INT,
    FOREIGN KEY (D_No) REFERENCES DEPARTMENT(D_No)
);

CREATE TABLE WORKS_ON (
    SSN INT,
    P_No INT,
    Hours DECIMAL(5,2),
    PRIMARY KEY (SSN, P_No),
    FOREIGN KEY (SSN) REFERENCES EMPLOYEE(SSN),
    FOREIGN KEY (P_No) REFERENCES PROJECT(P_No)
);



SELECT DISTINCT P.P_No
FROM PROJECT P
JOIN DEPARTMENT D ON P.D_No = D.D_No
JOIN EMPLOYEE E1 ON D.Mgr_SSN = E1.SSN
WHERE E1.Name LIKE '%Scott'
UNION
SELECT DISTINCT W.P_No
FROM WORKS_ON W
JOIN EMPLOYEE E2 ON W.SSN = E2.SSN
WHERE E2.Name LIKE '%Scott';


SELECT SUM(E.Salary) AS Total_Salary,
       MAX(E.Salary) AS Max_Salary,
       AVG(E.Salary) AS Avg_Salary
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.D_No = D.D_No
WHERE D.D_Name = 'Accounts';

